import{j as e,S as k,C as g,B as f,E as j}from"./index-DKDRh3Ci.js";import{h as w,f as C,c as m}from"./react-vendor-CYaOf62E.js";import{l as I}from"./questionLoader-DjJgUGhF.js";import"./Badge-DEFM6kQD.js";import"./ProgressRing-Babo_OKD.js";import"./Modal-B4PKGg3O.js";import"./supabase-Dgb8Dr8T.js";function E(n,x,l){try{const d=`practice-progress-${n}-${x}-${l}`,s=localStorage.getItem(d);if(!s)return{attempted:0,correct:0,percentage:0};const i=JSON.parse(s),c=i.total>0?Math.round(i.attempted/i.total*100):0;return{attempted:i.attempted||0,correct:i.correct||0,percentage:c}}catch(d){return console.error("Error reading progress from localStorage:",d),{attempted:0,correct:0,percentage:0}}}function S(n,x){const l=new Map;n.forEach(s=>{if(!l.has(s.unitId)){const o=parseInt(s.unitId.substring(1)),h=s.unitTitle||`Unit ${o}`;l.set(s.unitId,{unitId:s.unitId,unitNumber:o,unitTitle:h,questionCount:0,chapters:[]})}const i=l.get(s.unitId);i.questionCount++;let c=i.chapters.find(o=>o.chapterId===s.chapterId);if(!c){const o=s.chapterTitle||`Chapter ${s.chapterId}`;c={chapterId:s.chapterId,chapterTitle:o,questionCount:0,progress:E(x,s.unitId,s.chapterId)},i.chapters.push(c)}c.questionCount++});const d=Array.from(l.values()).sort((s,i)=>s.unitNumber-i.unitNumber);return d.forEach(s=>{s.chapters.sort((i,c)=>i.chapterId.localeCompare(c.chapterId,void 0,{numeric:!0}))}),d}function W(){const{examSlug:n}=w(),x=C(),[l,d]=m.useState([]),[s,i]=m.useState(new Set),[c,o]=m.useState(!0),[h,p]=m.useState(null);m.useEffect(()=>{async function r(){if(!n){p("No exam specified"),o(!1);return}if(!j[n]){p("Invalid exam"),o(!1);return}try{o(!0),p(null);const a=await I(n);if(a.length===0)throw new Error("No questions found for this exam");const t=S(a,n);d(t),t.length>0&&t[0]&&i(new Set([t[0].unitId]))}catch(a){console.error("Error loading questions:",a),p(a instanceof Error?a.message:"Failed to load questions")}finally{o(!1)}}r()},[n]);const N=r=>{i(a=>{const t=new Set(a);return t.has(r)?t.delete(r):t.add(r),t})},u=(r,a)=>{if(!n)return;const t=new URLSearchParams({exam:n,unit:r,chapter:a});x(`/quiz?${t.toString()}`)},v=r=>{const a=r.percentage;let t="bg-gray-300";return a>=80?t="bg-green-500":a>=50?t="bg-yellow-500":a>0&&(t="bg-blue-500"),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full ${t} transition-all duration-300`,style:{width:`${a}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-700 w-12 text-right",children:[a,"%"]})]})};if(c)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(k,{size:"lg",color:"primary"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading practice questions..."})]})});if(h||!n)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:e.jsxs(g,{padding:"lg",className:"max-w-md w-full text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12 text-error-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:h||"Invalid exam"}),e.jsx(f,{variant:"primary",onClick:()=>x(n?`/exam/${n}`:"/"),children:"Back to Exam"})]})});const y=j[n];return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:e.jsxs("div",{className:"container mx-auto max-w-5xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("button",{onClick:()=>x(`/exam/${n}`),className:"text-gray-600 hover:text-gray-900",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("span",{className:"text-sm text-gray-500",children:y.name})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Practice by Unit & Chapter"}),e.jsx("p",{className:"text-gray-600",children:"Select a chapter below to practice questions from that specific topic"})]}),e.jsx("div",{className:"space-y-4",children:l.map(r=>{const a=s.has(r.unitId);return e.jsxs(g,{padding:"none",className:"overflow-hidden",children:[e.jsx("div",{className:"p-6 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>N(r.unitId),children:e.jsxs("div",{className:"flex items-center gap-3",children:[a?e.jsx("svg",{className:"h-5 w-5 text-gray-400 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):e.jsx("svg",{className:"h-5 w-5 text-gray-400 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Unit ",r.unitNumber,": ",r.unitTitle]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r.questionCount," questions Â· ",r.chapters.length," chapters"]})]}),e.jsx("span",{className:"text-sm text-gray-400",children:a?"Click to collapse":"Click to expand"})]})}),a&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50",children:e.jsx("div",{className:"p-4 space-y-3",children:r.chapters.map(t=>e.jsxs("div",{className:"bg-white rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer border border-gray-200",onClick:()=>u(r.unitId,t.chapterId),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-1",children:["Chapter ",t.chapterId,": ",t.chapterTitle]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.questionCount," questions"]})]}),e.jsxs(f,{variant:"primary",size:"sm",onClick:b=>{b.stopPropagation(),u(r.unitId,t.chapterId)},children:[e.jsxs("svg",{className:"h-4 w-4 mr-1 inline-block",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Practice"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Progress"}),e.jsxs("span",{className:"text-xs text-gray-600",children:[t.progress.attempted," / ",t.questionCount," attempted"]})]}),v(t.progress)]})]},t.chapterId))})})]},r.unitId)})}),e.jsxs("div",{className:"mt-8 text-center text-sm text-gray-500",children:[e.jsx("p",{children:"Click on a unit to expand and see its chapters"}),e.jsxs("p",{children:["Click the ",e.jsx("strong",{children:"Practice"})," button on any chapter to start"]})]})]})})}export{W as PracticePage};
//# sourceMappingURL=PracticePage-DDLZTUK5.js.map
